-- 17.DEZ.2018
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('c8d803cf-7427-492b-b8a7-a61bce80895f', 'de');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('3e95c3ae-8baf-4c31-b847-5b21cdf0a7d3', 'a');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('a5e731e7-a9af-4504-8153-2f0fbaa90a9e', 'em');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('6c02a73c-b7bf-49da-89d7-1c6fae19a059', 'para');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('94cef9e7-e9d2-43d1-8466-9456120a752c', 'com');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('627251d0-a2d0-4307-8075-af92febc0882', 'por');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('825af51c-1171-44b2-8162-c1bc768e9815', 'um');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('a3754d33-7154-4828-92a9-04c89caa36fe', 'uma');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('8bd32128-852c-48cc-ae1c-6a5ea58011e4', 'o');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('57593fa6-1a34-4ff7-bfc3-5af9009e9040', 'no');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('c2003215-2239-4304-911d-6786068e4bf8', 'os');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('b756830f-b9da-4d44-8fa8-173cbbeac0d7', 'as');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('cd2a2066-b024-4e4b-84fa-acf1bda5829e', 'e');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('692f3654-c76e-4b30-ae11-69fe5c5a9728', 'do');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('7178113d-f5e6-4028-aaf7-d5634c552744', 'da');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('7c55acad-02aa-4d82-85bd-41d8a0236f4a', 'dos');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('1f429e77-b576-48f0-977d-19d030cd8745', 'das');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('9e45baf2-a149-4abe-938e-f2d15808f1a4', 'in');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('09fa1c86-51f3-4e1e-84db-0bf97e0132a6', 'and');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('ffe57f14-dc9f-4808-9c16-2fc549e067d8', 'of');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('b90446eb-8873-4be9-891a-28fb7655cbf6', 'the');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('e188ae51-c2f9-4bb4-8709-61c0764f36ac', 'by');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('8fa762dd-6177-4e4e-90f4-6cc36dfa43a2', 'que');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('9146434c-2ba2-4b64-88b4-f904d4f1766c', 'to');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('d12b352c-ebe0-48ad-85af-ba4ccdea37d6', 'at');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('cf9b7995-6a18-4769-bcf8-f1e6e340f667', 'UFO');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('8993cb30-2cce-4115-9cce-d5f2c688193c', 'ST');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('708ca881-e3bb-4d27-a31a-4c8704a67d04', 'V');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('aeb7b5fd-e7ad-4d20-8acf-c015cf2366b2', 'BD');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('b14bc5dd-1d32-43a3-8ac1-0fa366aaaa10', 'IX');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('a1dea7ed-7ff0-4ec9-8dd9-36b3d634f93e', 'III');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('719c1f7d-bb08-498d-898b-0752f69159b0', 'IV');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('f8a9abc6-8fea-4e85-9176-cce74878ec1f', 'I');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('071036b7-b215-4505-9e53-df2a4e057c43', 'II');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('3c2d9acd-e798-4d41-be55-46dc7d66c774', 'OVNI');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('2360c35b-5986-489d-80d9-27d649598434', 'XV');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('4e8d6608-734a-4852-906b-06190dda977d', 'XI');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('7a44a9a9-4c2c-4f12-93e1-bb899d474850', 'VIII');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('a0a02ed1-b145-44ec-b061-8cdba79b38d8', 'XII');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('ee7333ef-15c6-411c-8646-0b30587e3bd5', 'XXI');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('67eed3b3-751b-4d96-948b-849d48b8e55e', 'XVII');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('f0ddb612-c03c-48a4-9cc4-8641835bf424', 'VII');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('314a85a7-2fe1-4ae3-98eb-a650df3f997e', 'VI');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('4ccad984-4c04-4f5b-b1f7-6974bb837940', 'XIX');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('cf3c7db3-4d4e-425d-8376-cb1e5e764032', 'X');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('4c6854c2-93dc-478f-ba4c-94b0078bb970', 'XVI');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('ca69ccec-8a66-4fd5-af1c-55a9f194d3ba', 'XVIII');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('d551c5e2-c974-44b4-b991-239cf69e42c4', 'XIV');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('56ef2df5-185e-46ef-a507-c6e95ff0e144', 'XIII');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('d4903593-7c94-46bd-b9c9-5b849cc84599', 'XX');
INSERT INTO public.prep (prep_uuid, prep_word) VALUES ('3a8d8466-6568-4d37-a9d8-93541b97e5d0', 'ZX');
-- 15.DEZ.2018
CREATE EXTENSION "uuid-ossp";
create table if not exists prep
(
	prep_uuid uuid DEFAULt uuid_generate_v4() not null,
	prep_word varchar(10) not null
		constraint prep_pk
			primary key
);

alter table prep owner to root;

create unique index prep_prep_uuid_uindex
	on prep (prep_uuid);

create unique index prep_prep_word_uindex
	on prep (prep_word);
-- 12.DEZ.2018
INSERT INTO "public"."params" ("param_key", "param_data") VALUES ('OWNER', 'Euzinho')
-- 11.DEZ.2018
alter table livros drop pu_type;
ALTER TABLE public.livros RENAME COLUMN pu_genere TO pu_type;
drop table types;
alter table genero rename to types;
alter table types rename column ge_id to ty_id;
alter table types rename column ge_title to ty_name;
alter table types drop pu_type;
CREATE extension unaccent;
CREATE TABLE public.params
(
    param_key character(4) PRIMARY KEY NOT NULL,
    param_json text NOT NULL
);
CREATE UNIQUE INDEX params_param_key_uindex ON public.params (param_key);
ALTER TABLE public.tags ALTER COLUMN ta_name TYPE varchar(45) USING ta_name::varchar(60);
update livros set pu_subject=1 where pu_subject=0;
drop table param;
drop table parms;
drop table params;
alter table livros drop pu_bd_hero;
alter table livros drop pu_isbn10;
alter table livros drop pu_lang;
alter table livros drop pu_origem;
alter table livros drop pu_fisico;
alter table livros drop pu_ed_year;
alter table livros drop pu_serie;

alter table livros drop pu_bd_fasc_number;
alter table livros drop pu_bd_fasc_year;
ALTER TABLE public.livros ADD pu_ed_year smallint NULL;
update livros set pu_ed_date=Null where pu_ed_date='';
update livros set pu_author_id=464 where pu_author_id=463;
delete from authors where au_id = 463;
update livros set pu_author_others=Null where pu_author_others='';
update livros set pu_isbn=replace(pu_isbn,'-','');
ALTER TABLE public.livros ALTER COLUMN pu_isbn TYPE varchar(13) USING pu_isbn::varchar(13);
update livros set pu_cota=upper(pu_cota);
alter table authors drop pu_type;
delete from types where ty_id=5;
CREATE TABLE params
(
  param_key character varying(20) NOT NULL,
  param_data text,
  CONSTRAINT params_pkey PRIMARY KEY (param_key)
)
WITH (OIDS=FALSE);
ALTER TABLE params OWNER TO root;
CREATE UNIQUE INDEX params_param_key_uindex
  ON params  USING btree  (param_key COLLATE pg_catalog."default");
INSERT INTO params(param_key, param_data) VALUES ('LAST_TAGS', 'capa mole,inglês,técnico');
INSERT INTO params(param_key, param_data) VALUES ('SHOW_RECORDS', '80');

-- post converter
drop table assuntos;
drop table collection;
drop table series;
drop table system;
drop table hero;
drop table publishers;
drop table media_formats;
drop table media;
drop table languages;
alter table livros drop pu_collection;
alter table livros drop pu_language;
alter table livros drop pu_media;
alter table livros drop pu_pages;
alter table livros drop pu_title_original;
alter table livros drop pu_collection_number;
alter table livros drop pu_translator;
alter table livros drop pu_edition_number;
alter table livros drop pu_ed_local;
alter table livros drop pu_ed_date;
alter table livros drop pu_volumes;
alter table livros drop pu_language;
alter table livros drop pu_collection;
alter table livros drop pu_author_others;
alter table livros drop pu_edition_number;
alter table livros drop pu_deplegal;
alter table livros drop pu_editor_id;
alter table livros drop pu_title_original;
alter table livros drop pu_media_format;
alter table livros drop pu_subject;
update livros set pu_ed_year = Null where pu_ed_year=0;
update livros set pu_author_id=879 where pu_author_id=878;
delete from authors where au_id=878;
drop sequence herois_he_id_seq;
drop sequence series_serie_id_seq;
-- init
delete from authors;
delete from livros;
delete from status where st_id>1;
delete from tags;
delete from tag_ref;
delete from types where ty_id>1;
ALTER SEQUENCE author_authorid_seq restart with 1;
alter sequence generoid_seq restart with 2;
alter sequence livros_livroid_seq restart with 1;
alter sequence parms_pm_id_seq restart with 1;
alter sequence statusid_seq restart with 2;
alter sequence tag_ref_id_seq restart with 1;
alter sequence tags_ta_id_seq restart with 1;

